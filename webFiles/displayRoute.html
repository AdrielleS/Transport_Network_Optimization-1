<!DOCTYPE html>
<html>
  <head>
    <title>Simple Map</title>
    <meta name="viewport" content="initial-scale=1.0">
    <meta charset="utf-8">
    <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 100%;
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
  </head>
  <body>
    <div id="map"></div>
    <script>
      function initMap() {
		var service = new google.maps.DirectionsService;
		var map = new google.maps.Map(document.getElementById('map'));

		// list of points
		var stations = [
{lat: -8.008477777777777, lng: -34.93841111111111, name: '110000'},
{lat: -8.010288888888889, lng: -34.93579722222222, name: '110001'},
{lat: -8.012033333333333, lng: -34.93380277777777, name: '110002'},
{lat: -8.01368888888889, lng: -34.931711111111106, name: '110003'},
{lat: -8.016958333333335, lng: -34.93003611111111, name: '110004'},
{lat: -8.018811111111113, lng: -34.928105555555554, name: '110005'},
{lat: -8.020708333333333, lng: -34.92572222222222, name: '110006'},
{lat: -8.020800000000001, lng: -34.92310277777778, name: '110007'},
{lat: -8.02108888888889, lng: -34.920366666666666, name: '110008'},
{lat: -8.0213, lng: -34.91799722222222, name: '110009'},
{lat: -8.02246388888889, lng: -34.91500277777778, name: '110010'},
{lat: -8.023305555555556, lng: -34.913644444444444, name: '110011'},
{lat: -8.024602777777778, lng: -34.910402777777776, name: '110012'},
{lat: -8.025575000000002, lng: -34.90687777777778, name: '110013'},
{lat: -8.027258333333334, lng: -34.90410277777777, name: '110014'},
{lat: -8.029275, lng: -34.901155555555555, name: '110015'},
{lat: -8.03061388888889, lng: -34.89921666666667, name: '110016'},
{lat: -8.032475000000002, lng: -34.89727222222222, name: '110017'},
{lat: -8.034883333333333, lng: -34.895802777777774, name: '110018'},
{lat: -8.038136111111111, lng: -34.89308333333333, name: '110019'},
{lat: -8.039225, lng: -34.89017222222222, name: '110020'},
{lat: -8.039755555555555, lng: -34.887972222222224, name: '110021'},
{lat: -8.04111111111111, lng: -34.886227777777776, name: '110022'},
{lat: -8.04416111111111, lng: -34.88207222222222, name: '110023'},
{lat: -8.045213888888888, lng: -34.88010555555556, name: '110024'},
{lat: -8.04705, lng: -34.87777777777778, name: '110025'},
{lat: -8.050184, lng: -34.879016, name: '180100'},
{lat: -8.051677, lng: -34.88003, name: '180101'},
{lat: -8.056653, lng: -34.882938, name: '180290'},
{lat: -8.059736, lng: -34.883759, name: '180291'},
{lat: -8.061634, lng: -34.88256, name: '180292'},
{lat: -8.064227, lng: -34.878595, name: '180295'},
{lat: -8.066082, lng: -34.878477, name: '180297'},
{lat: -8.064378, lng: -34.876292, name: '180298'},
{lat: -8.062845, lng: -34.876799, name: '180299'},
{lat: -8.062782, lng: -34.880096, name: '180300'},
{lat: -8.058666666666667, lng: -34.883266666666664, name: '180074'},
{lat: -8.056509, lng: -34.882611, name: '180102'},
{lat: -8.054275, lng: -34.88167777777778, name: '180103'},
{lat: -8.051630555555557, lng: -34.879783333333336, name: '180104'},
{lat: -8.049016666666667, lng: -34.87704166666667, name: '180105'},
{lat: -8.0463, lng: -34.87844722222222, name: '110028'},
{lat: -8.045294444444444, lng: -34.87968055555556, name: '110029'},
{lat: -8.043922222222221, lng: -34.88209166666667, name: '110030'},
{lat: -8.040013888888888, lng: -34.88717222222222, name: '110031'},
{lat: -8.039222, lng: -34.888823, name: '110032'},
{lat: -8.037861111111111, lng: -34.893188888888886, name: '110034'},
{lat: -8.034619444444445, lng: -34.89576666666667, name: '110035'},
{lat: -8.032958333333335, lng: -34.89669166666667, name: '110036'},
{lat: -8.030355555555557, lng: -34.899252777777775, name: '110037'},
{lat: -8.028377777777779, lng: -34.902138888888885, name: '110038'},
{lat: -8.0272, lng: -34.903875, name: '110039'},
{lat: -8.025702777777779, lng: -34.90613611111111, name: '110040'},
{lat: -8.024575, lng: -34.909794444444444, name: '110041'},
{lat: -8.023333333333333, lng: -34.913269444444445, name: '110042'},
{lat: -8.022352777777778, lng: -34.91486111111111, name: '110043'},
{lat: -8.021402777777778, lng: -34.91686111111111, name: '110044'},
{lat: -8.020961111111111, lng: -34.92001666666666, name: '110045'},
{lat: -8.020533333333335, lng: -34.92373611111111, name: '110046'},
{lat: -8.020080555555557, lng: -34.92615833333333, name: '110047'},
{lat: -8.01838, lng: -34.928147, name: '110048'},
{lat: -8.016513, lng: -34.929774, name: '110049'},
{lat: -8.014312, lng: -34.931401, name: '110050'},
{lat: -8.01197, lng: -34.933059, name: '110051'},
{lat: -8.009838, lng: -34.935847, name: '110052'},
{lat: -8.008477777777777, lng: -34.93841111111111, name: '110000'},
		];
		
		// Zoom and center map automatically by stations (each station will be in visible map area)
		var lngs = stations.map(function(station) { return station.lng; });
		var lats = stations.map(function(station) { return station.lat; });
		map.fitBounds({
			west: Math.min.apply(null, lngs),
			east: Math.max.apply(null, lngs),
			north: Math.min.apply(null, lats),
			south: Math.max.apply(null, lats),
		});
		
		// Show stations on the map as markers
		for (var i = 0; i < stations.length; i++) {
			if (!stations[i].name)
				continue;
			new google.maps.Marker({
				position: stations[i],
				map: map,
				title: stations[i].name
			});
		}

		// Divide route to several parts because max stations limit is 25 (23 waypoints + 1 origin + 1 destination)
		for (var i = 0, parts = [], max = 8 - 1; i < stations.length; i = i + max)
			parts.push(stations.slice(i, i + max + 1));

		// Callback function to process service results
		var service_callback = function(response, status) {
			if (status != 'OK') {
				console.log('Directions request failed due to ' + status);
				return;
			}
			var renderer = new google.maps.DirectionsRenderer;
			renderer.setMap(map);
			renderer.setOptions({ suppressMarkers: true, preserveViewport: true });
			renderer.setDirections(response);
		};
			
		// Send requests to service to get route (for stations count <= 25 only one request will be sent)
		for (var i = 0; i < parts.length; i++) {
			// Waypoints does not include first station (origin) and last station (destination)
			var waypoints = [];
			for (var j = 1; j < parts[i].length - 1; j++)
				waypoints.push({location: parts[i][j], stopover: true});
			// Service options
			var service_options = {
				origin: parts[i][0],
				destination: parts[i][parts[i].length - 1],
				waypoints: waypoints,
				travelMode: 'DRIVING',
			};
			// Send request
			service.route(service_options, service_callback);
		}
	  }
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA4nuxucJdREFeUZ_8NtmgtX1tBf1ShurU&callback=initMap"
    async defer></script>
  </body>
</html>